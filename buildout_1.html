
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    

    <title>10. Buildout I &mdash; Mastering Plone 1.1 documentation</title>

<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/>


    
    <link rel="stylesheet" href="_static/rtd.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/searchtools.js"></script>
    <link rel="top" title="Mastering Plone 1.1 documentation" href="index.html" />
    <link rel="next" title="11. IDE’s and Editors" href="ide.html" />
    <link rel="prev" title="9. Theming" href="theming.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="ide.html" title="11. IDE’s and Editors"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="theming.html" title="9. Theming"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Mastering Plone 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="buildout-i">
<h1>10. Buildout I<a class="headerlink" href="#buildout-i" title="Permalink to this headline">¶</a></h1>
<div class="highlight-cfg"><div class="highlight"><pre><span class="na">parts</span> <span class="o">=</span><span class="s"></span>
<span class="s">    alpha</span>
<span class="s">    beta</span>
</pre></div>
</div>
<p>A Buildout consists of multiple sections. Sections start with the section name in square brackets. Each section declares a different part of your application. As a rough analogy, your Buildout file is a cookbook with multiple recipes.</p>
<p>There is a special section, called Buildout.</p>
<p>This section can change the behavior of Buildout, but what is most important, is the variable <tt class="docutils literal"><span class="pre">parts</span></tt> here. This defines, which sections should actually be interpreted.</p>
<p>Buildout itself has no idea, how to install Zope. Buildout is a plugin based system, it comes with a small set of plugins to create configuration files and download eggs with their dependencies and the proper version. To install a Zope site, you need a third-party plugin. The plugin provide new recipes that you have to declare and configure in a section.</p>
<p>Let us walk through our <tt class="docutils literal"><span class="pre">buildout.cfg</span></tt> and look at some important variables:</p>
<div class="highlight-cfg"><div class="highlight"><pre><span class="k">[buildout]</span>
<span class="na">parts</span> <span class="o">=</span><span class="s"></span>
<span class="s">    instance</span>
<span class="s">    omelette</span>
<span class="s">    zopeskel</span>

<span class="na">extends</span> <span class="o">=</span><span class="s"></span>
<span class="s">    http://dist.plone.org/release/4.3.2/versions.cfg</span>
<span class="s">    versions.cfg</span>

<span class="na">find-links</span> <span class="o">=</span> <span class="s">http://dist.repoze.org/</span>

<span class="c1"># A test-pypi to publish eggs</span>
<span class="c1">#index = http://testpypi.python.org/simple/</span>

<span class="c1">#extensions = mr.developer</span>
<span class="c1">#sources = sources</span>
<span class="c1">#auto-checkout =</span>
<span class="c1">#    plonekonf.talk</span>
<span class="c1">#    starzel.votable_behavior</span>

<span class="na">versions</span> <span class="o">=</span> <span class="s">versions</span>

<span class="k">[instance]</span>
<span class="na">recipe</span> <span class="o">=</span> <span class="s">plone.recipe.zope2instance</span>
<span class="na">eggs</span> <span class="o">=</span><span class="s"></span>
<span class="s">    Plone</span>
<span class="s">    Pillow</span>
<span class="c1">#    Products.PloneFormGen</span>
<span class="c1">#    Products.LinguaPlone</span>
<span class="c1">#    collective.plonetruegallery</span>
<span class="c1">#    plone.app.themeeditor</span>
<span class="c1">#    z3c.jbot</span>
<span class="c1">#    plonekonf.talk</span>
<span class="c1">#    starzel.votable_behavior</span>

<span class="na">user</span> <span class="o">=</span> <span class="s">admin:admin</span>
<span class="c1"># The following is only used when we use vagrant.</span>
<span class="c1"># The shared folder should not contain &quot;big data&quot; or symbolic links.</span>
<span class="na">file-storage</span> <span class="o">=</span> <span class="s">/home/vagrant/var/filestorage/Data.fs</span>
<span class="na">blob-storage</span> <span class="o">=</span> <span class="s">/home/vagrant/var/blobstorage</span>

<span class="k">[omelette]</span>
<span class="na">recipe</span> <span class="o">=</span> <span class="s">collective.recipe.omelette</span>
<span class="na">eggs</span> <span class="o">=</span> <span class="s">${instance:eggs}</span>
<span class="c1"># Same as above: We dont want links in the shared folder.</span>
<span class="c1"># The default omelette-dir is parts/omelette</span>
<span class="na">location</span> <span class="o">=</span> <span class="s">/home/vagrant/omelette</span>

<span class="k">[zopeskel]</span>
<span class="c1"># installs paster and Zopeskel</span>
<span class="na">recipe</span> <span class="o">=</span> <span class="s">zc.recipe.egg</span>
<span class="na">eggs</span> <span class="o">=</span><span class="s"></span>
<span class="s">    PasteScript</span>
<span class="s">    ZopeSkel</span>
<span class="s">    ${instance:eggs}</span>

<span class="k">[sources]</span>
<span class="c1">#plonekonf.talk = git https://github.com/starzel/plonekonf.talk.git</span>
<span class="c1">#starzel.votable_behavior = git git://github.com/starzel/starzel.votable_behavior.git</span>
</pre></div>
</div>
<p>When you run Buildout without any arguments, Buildout will look for this file.</p>
<div class="highlight-cfg"><div class="highlight"><pre><span class="na">extends</span> <span class="o">=</span>
</pre></div>
</div>
<p>This line tells Buildout, to read more configuration files. You can refer to configuration files on your computer or to configuration files on the Internet, reachable via http. You can use multiple configuration files to share configurations between multiple Buildouts, or to separate different aspects of your configuration into different files. Typical examples are version specifications, or configuration that differ between different environments.</p>
<div class="highlight-cfg"><div class="highlight"><pre><span class="na">http-address</span> <span class="o">=</span>
</pre></div>
</div>
<p>That is the port on which Zope will listen for requests</p>
<div class="highlight-cfg"><div class="highlight"><pre><span class="na">eggs</span> <span class="o">=</span>
</pre></div>
</div>
<p>This is the list of Eggs that the Zope server must have available.</p>
<div class="highlight-cfg"><div class="highlight"><pre><span class="na">develop</span> <span class="o">=</span>
</pre></div>
</div>
<p>Here you list Eggs that you are developing. They are not available as eggs but as a folder with a specific structure. Zope has to load eggs slightly different to these so-called <tt class="docutils literal"><span class="pre">checkouts</span></tt>.</p>
<p>There are many more important things to know, and we can&#8217;t go through them in all the detail but I want to focus on one specific feature: <strong>mr.developer</strong></p>
<p>With mr.developer, you can declare, which packages you want to check out from which version control system and which repository URL. You can check out sources from git, svn, bzr, hg and maybe more. Also, you can say that some source are in your local file system.</p>
<p><tt class="docutils literal"><span class="pre">mr.developer</span></tt> comes with a command, <tt class="docutils literal"><span class="pre">./bin/develop</span></tt>. You can use it to update your code, to check for changes and so on. You can activate and deactivate your source checkouts. If you develop your extensions in eggs with separate checkouts, which is a good practice, you can plan releases by having all source checkouts deactivated, and only activate them, when you write changes that require a new release. You can activate and deactivate eggs via the develop command or the Buildout configuration. You should always use the Buildout way. Your commit serves as documentation.</p>
<p><strong>versions.cfg</strong></p>
<p>Keeping versions in a separate files help to keep your Buildout configuration file small.</p>
<div class="highlight-cfg"><div class="highlight"><pre><span class="k">[versions]</span>
</pre></div>
</div>
<p>This is another special section. You might have noticed that most if not all functionality is only available via plugins. One of the things that Buildout excels at without any plugin, is the dependency resolution. You can help Plone in dependency resolution by declaring exactly which version of an egg you want. This is only one use case. Another one is much ,more important. If you want to have a repeatable Buildout, one that works two months from now also, you MUST declare all your egg versions. Else Buildout might install newer versions.</p>
<p>Ok, let us change things.</p>
<p>We want to install something very important, the omelette recipe. This thing creates a very convenient way to access all used source code. It creates a lot of symlinks to point to the real file. We will see this in more detail later. There is something special we have to take care of. Our Buildout directory is in the shared directory, and unfortunately this does not work will a number of things, one of them is our omelette.</p>
<p>So we do not use the defaults, we change our path.</p>
<p>Here you see some important property, you can reference data from other sections. This is an important property, on a big site you might have multiple Zope instance with only minor differences. You can define the minor differences and pull in the general settings from a template section. This way you only need to change variables in one place.</p>
<p>Or, even better, if you define services that work together, you can reference each others listening interfaces. So a nginx gets the port information from the Buildout.</p>
<p>As you can see, you can build very complex systems with Buildout. It is time for some warnings. Be selective in your recipes. Supervisor is a program to manage running servers, its pretty good. There is a recipe for it.</p>
<p>The configuration is more complicated than the supervisor configuration itself! By using this recipe, you force others to understand the recipes specific configuration syntax AND the supervisor syntax. For such cases, collective.recipe.template might be a better match.</p>
<p>Another problem is error handling. Buildout tries to install a weird dependency you do not actually want? Buildout will not tell you, where it is coming from.</p>
<p>If there is a problem, you can always run Buildout with -v, to get more verbose output, sometimes it helps.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>./bin/buildout -v
</pre></div>
</div>
<p>If strange egg versions are requested, check the dependencies declaration of your eggs and your version pinnings.</p>
<p>Some parts of Buildout interpret egg names case-sensitive, others won&#8217;t. This can result in funny problems.</p>
<p>Always check out the ordering of your extends, always use the annotate command of Buildout to see if it interprets your configuration differently than you. Restrict yourself to simple Buildout files. You can reference variables from other sections, you can even use a whole section as a template. We learned that this does not work well with complex hierarchies and had to abandon that feature.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">2. Installation &amp; Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="plone_training_config/instructions.html">3. Installing Plone for the Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="anatomy.html">4. The Anatomy of Plone</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">5. The Features of Plone</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuring_customizing.html">6. Configuring and Customising Plone through the web</a></li>
<li class="toctree-l1"><a class="reference internal" href="extending.html">7. Extending Plone</a></li>
<li class="toctree-l1"><a class="reference internal" href="addons.html">8. Extend Plone with Add-ons</a></li>
<li class="toctree-l1"><a class="reference internal" href="theming.html">9. Theming</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">10. Buildout I</a></li>
<li class="toctree-l1"><a class="reference internal" href="ide.html">11. IDE&#8217;s and Editors</a></li>
<li class="toctree-l1"><a class="reference internal" href="eggs.html">12. Creating your own eggs to customize Plone</a></li>
<li class="toctree-l1"><a class="reference internal" href="dexterity.html">13. Creating content-types with Dexterity</a></li>
<li class="toctree-l1"><a class="reference internal" href="views_1.html">14. Views I</a></li>
<li class="toctree-l1"><a class="reference internal" href="zpt.html">15. Zope Page Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="zpt_2.html">16. Customizing existing templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="views_2.html">17. Views II: A default view for &#8220;talk&#8221;</a></li>
<li class="toctree-l1"><a class="reference internal" href="views_3.html">18. Views III: A Talk list</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_search.html">19. Custom search</a></li>
<li class="toctree-l1"><a class="reference internal" href="ressources.html">20. Ressources</a></li>
<li class="toctree-l1"><a class="reference internal" href="social_behavior.html">21. Social behavior</a></li>
<li class="toctree-l1"><a class="reference internal" href="viewlets.html">22. Writing Viewlets</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment_code.html">23. Deploying your code</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment_sites.html">24. Buildout II: Deploying your site</a></li>
<li class="toctree-l1"><a class="reference internal" href="future_of_plone.html">25. The Future of Plone</a></li>
<li class="toctree-l1"><a class="reference internal" href="optional.html">26. Optional</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="ide.html" title="11. IDE’s and Editors"
             >next</a></li>
        <li class="right" >
          <a href="theming.html" title="9. Theming"
             >previous</a> |</li>
        <li><a href="index.html">Mastering Plone 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
<div class="footer">
    &copy; Copyright 2013, Philip Bauer, Patrick Gerken.
  Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
  <br />Theme based on <a href="http://readthedocs.org/">Read The Docs</a>

</div>





  </body>
</html>